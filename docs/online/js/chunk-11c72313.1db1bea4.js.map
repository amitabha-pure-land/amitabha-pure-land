{"version":3,"sources":["webpack:///./src/views/StudentManagement.vue?4857","webpack:///./src/components/ClassAdmin.vue?abbe","webpack:///src/components/ClassAdmin.vue","webpack:///./src/components/ClassAdmin.vue?9198","webpack:///./src/components/ClassAdmin.vue","webpack:///src/views/StudentManagement.vue","webpack:///./src/views/StudentManagement.vue?5e1c","webpack:///./src/views/StudentManagement.vue","webpack:///./src/components/ClassTeam.vue?5a48","webpack:///src/components/ClassTeam.vue","webpack:///./src/components/ClassTeam.vue?0076","webpack:///./src/components/ClassTeam.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","classInfo","name","key","initComponentKey","attrs","staticClass","directives","rawName","value","expression","domProps","on","$event","target","composing","newClassTeamName","createClassTeam","submitClassTeams","_e","resetClassTeams","removedStudents","length","dummyClassTeam","_l","classTeam","index","id","removeClass","staticRenderFns","member","role","displayName","classAdminOptions","changeMember","model","newClassAdmins","callback","$$v","$set","props","forStudentManagement","Boolean","data","classAdminCandidates","classStatsCandidates","computed","buildNewClassAdmin","buildOptions","methods","i","classAdminUsers","user","push","classAdminStudents","roles","some","concat","map","e","classTeams","team","j","members","text","console","log","options","option","$store","dispatch","component","components","ClassTeam","ClassAdmin","to","from","next","store","creatingClassTeam","Date","getTime","dummy","classId","splice","okText","cancelText","loader","message","title","body","thisComponent","$dialog","filter","classAdminUserIds","lastWeek","toString","replace","count","isClassAdmin","forAdmin","practiceId","completed","setCompleted","classTeamOptions","assignTeam","setLeader","removeMember","canAddSubmodule","assignedTeamId","JSON","stringify","msg","practiceName"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAAEJ,EAAqB,kBAAEI,EAAG,MAAM,CAACJ,EAAIM,GAAG,2BAA2BF,EAAG,MAAM,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGP,EAAIQ,UAAUC,MAAM,cAAcL,EAAG,aAAa,CAACM,IAAIV,EAAIW,iBAAiBC,MAAM,CAAC,sBAAuB,KAAQR,EAAG,MAAMA,EAAG,MAAM,CAACS,YAAY,oBAAoB,CAACT,EAAG,QAAQ,CAACU,WAAW,CAAC,CAACL,KAAK,QAAQM,QAAQ,UAAUC,MAAOhB,EAAoB,iBAAEiB,WAAW,qBAAqBJ,YAAY,eAAeD,MAAM,CAAC,KAAO,OAAO,mBAAmB,eAAe,YAAc,UAAUM,SAAS,CAAC,MAASlB,EAAoB,kBAAGmB,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOC,OAAOC,YAAqBtB,EAAIuB,iBAAiBH,EAAOC,OAAOL,WAAUZ,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,QAAQO,GAAG,CAAC,MAAQnB,EAAIwB,kBAAkB,CAACxB,EAAIM,GAAG,UAAWN,EAAqB,kBAAEI,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,WAAWO,GAAG,CAAC,MAAQnB,EAAIyB,mBAAmB,CAACzB,EAAIM,GAAG,UAAUN,EAAI0B,KAAM1B,EAAqB,kBAAEI,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,WAAWO,GAAG,CAAC,MAAQnB,EAAI2B,kBAAkB,CAAC3B,EAAIM,GAAG,UAAUN,EAAI0B,MAAM,GAAI1B,EAAI4B,gBAAgBC,OAAS,EAAGzB,EAAG,YAAY,CAACQ,MAAM,CAAC,UAAYZ,EAAI8B,oBAAoB9B,EAAI0B,KAAK1B,EAAI+B,GAAI/B,EAAc,YAAE,SAASgC,EAAUC,GAAO,OAAO7B,EAAG,MAAM,CAACM,IAAIsB,EAAUE,GAAKF,EAAUvB,KAAOwB,GAAO,CAAC7B,EAAG,YAAY,CAACQ,MAAM,CAAC,UAAYoB,KAAcC,EAAQ,EAAG7B,EAAG,WAAW,CAACQ,MAAM,CAAC,MAAQ,GAAG,QAAU,WAAWO,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAImC,YAAYF,MAAU,CAACjC,EAAIM,GAAG,UAAUN,EAAI0B,KAAKtB,EAAG,OAAO,OAAM,MAC1/CgC,EAAkB,G,wBCDlB,EAAS,WAAa,IAAIpC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,SAAS,CAACS,YAAY,cAAcD,MAAM,CAAC,OAAS,SAASZ,EAAI+B,GAAI/B,EAAmB,iBAAE,SAASqC,EAAOJ,GAAO,OAAO7B,EAAG,gBAAgB,CAACM,IAAIuB,EAAMpB,YAAY,OAAOD,MAAM,CAAC,QAAUyB,EAAOC,OAAO,CAAClC,EAAG,eAAe,CAACQ,MAAM,CAAC,SAAW,GAAG,MAAQyB,EAAOE,eAAenC,EAAG,uBAAuB,CAACA,EAAG,gBAAgB,CAACQ,MAAM,CAAC,QAAUZ,EAAIwC,kBAAkBP,IAAQd,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIyC,aAAarB,EAAQa,KAASS,MAAM,CAAC1B,MAAOhB,EAAI2C,eAAeV,GAAQW,SAAS,SAAUC,GAAM7C,EAAI8C,KAAK9C,EAAI2C,eAAgBV,EAAOY,IAAM5B,WAAW,4BAA4B,IAAI,MAAK,IAAI,IAC5rB,EAAkB,G,YCyBtB,GACER,KAAM,aACNsC,MAAO,CACLC,qBAAsBC,SAExBC,KAAM,WACJ,MAAO,CACLC,qBAAsB,GACtBC,qBAAsB,GACtBT,eAAgB,KAGpBU,SAAU,IACZ,8DAEE,UACEpD,KAAKqD,qBACLrD,KAAKsD,gBAEPC,QAAS,CACP,qBACE,MAAMb,EAAiB,GACvB,IAAK,IAAIc,EAAI,EAAGA,EAAIxD,KAAKyD,gBAAgB7B,OAAQ4B,IAAK,CACpD,MAAME,EAAO1D,KAAKyD,gBAAgBD,GAClCd,EAAeiB,KAAKD,EAAKzB,IAE3BjC,KAAK0C,eAAiBA,GAExB,eACE1C,KAAKkD,qBAAuB,GAC5B,IAAK,IAAIM,EAAI,EAAGA,EAAIxD,KAAKO,UAAUqD,mBAAmBhC,OAAQ4B,IAAK,CACjE,MAAME,EAAO1D,KAAKO,UAAUqD,mBAAmBJ,GAC3CE,GAAQA,EAAKG,MAAMC,KAAKzB,GAAgB,kBAARA,IAClCrC,KAAKkD,qBAAqBS,KAAKD,GAYnC,IARA1D,KAAKkD,qBAAuBlD,KAAKkD,qBAAqBa,OAC5D,qCAEM/D,KAAKkD,qBAAuBlD,KAAKkD,qBAAqBc,IAAIC,IACjD,CAAf,wCAGMjE,KAAKmD,qBAAuB,GACvBK,EAAI,EAAGA,EAAIxD,KAAKkE,WAAWtC,OAAQ4B,IAAK,CAC3C,MAAMW,EAAOnE,KAAKkE,WAAWV,GAC7B,IAAK,IAAIY,EAAI,EAAGA,EAAID,EAAKE,QAAQzC,OAAQwC,IAAK,CAC5C,MAAMhC,EAAS+B,EAAKE,QAAQD,GACvBpE,KAAKkD,qBAAqBY,KAAKG,GAAKA,EAAElD,OAASqB,EAAOH,KACzDjC,KAAKmD,qBAAqBQ,KAAK,CAC7B5C,MAAOqB,EAAOH,GACdqC,KAAMlC,EAAO5B,KACbqD,MAAOzB,EAAOyB,WAMxB,kBAAkB7B,GAChB,OAAIA,EAAQ,EACHhC,KAAKkD,qBAEPlD,KAAKmD,sBAEd,aAAapC,EAAOiB,GAClB,GAAIjB,GAASf,KAAKyD,gBAAgBzB,GAAOC,GACvC,OAGFsC,QAAQC,IAAI,YAAYzD,YAAgBiB,KACxC,MAAMyC,EAAUzE,KAAKuC,kBAAkBP,GAEvC,IAAK,IAAIwB,EAAI,EAAGA,EAAIiB,EAAQ7C,OAAQ4B,IAAK,CACvC,MAAMkB,EAASD,EAAQjB,GACvB,GAAIkB,EAAO3D,OAASA,EAAO,CACzBf,KAAKyD,gBAAgBzB,GAAOC,GAAKlB,EACjCf,KAAKyD,gBAAgBzB,GAAOxB,KAAOkE,EAAOlE,KAC1CR,KAAKyD,gBAAgBzB,GAAOM,YAAc,IAAIN,EAAQ,MAChE,SAEU,OAGJhC,KAAK2E,OAAOC,SAAS,EAA3B,sBC9GoV,I,YCOhVC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,yCC2Cf,GACErE,KAAM,oBACNsE,WAAY,CACVC,UAAJ,OACIC,WAAJ,GAEE5B,SAAU,IACZ,gBACA,oBACA,YACA,aACA,eACA,gBACA,oBACA,kBACA,mBACA,qBAGE,iBAAiB6B,EAAIC,EAAMC,GACzBC,EAAJ,yCACMD,OAGJlC,KAAM,WACJ,MAAO,CACL3B,iBAAkB,GAClB+D,mBAAmB,IAGvB9B,QAAS,CACP,iBACE,MAAO,CACLtB,GAAI,SAASjC,KAAKsB,qBAAoB,IAAIgE,MAAOC,YACjDC,OAAO,EACPhF,KAAM,QACN6D,QAASrE,KAAK2B,kBAGlB,kBACE,MAAMI,EAAY,CAChBE,GAAI,OAAOjC,KAAKsB,qBAAoB,IAAIgE,MAAOC,YAC/CE,QAASzF,KAAKO,UAAU0B,GACxBzB,KAAMR,KAAKsB,iBACX+C,QAAS,IAEXrE,KAAKsB,iBAAmB,GACxBtB,KAAKkE,WAAWP,KAAK5B,GACrBqD,EAAN,oCAEI,YAAYpD,GACVhC,KAAKkE,WAAW,GAAGG,QAAUrE,KAAKkE,WAAW,GAAGG,QAAQN,OAC9D,4BAEM/D,KAAKkE,WAAWwB,OAAO1D,EAAO,GAC9BoD,EAAN,oCAEI,kBACE,MAAMX,EAAU,CACdkB,OAAQ,KACRC,WAAY,KACZC,QAAQ,GAEJC,EAAU,CACdC,MAAO/F,KAAKO,UAAUC,KACtBwF,KAAM,WAEFC,EAAgBjG,KAEtBA,KAAKkG,QACX,aACA,kBACQ,EAAR,oBACQ,EAAR,qBACQ,EAAR,kCACQ,EAAR,WAEA,UACQ,QAAR,oBAGI,mBACE,MAAMzB,EAAU,CACdkB,OAAQ,KACRC,WAAY,KACZC,QAAQ,GAEJC,EAAU,CACdC,MAAO/F,KAAKO,UAAUC,KACtBwF,KAAM,WAEFC,EAAgBjG,KAChByF,EAAUzF,KAAKO,UAAU0B,GACzBiC,EAAalE,KAAKkE,WAAWiC,OAAOlC,GAAKA,EAAEhC,IAC3CN,EAAkB3B,KAAK2B,gBACvByE,EAAoBpG,KAAKyD,gBAAgBO,IAAIC,GAAKA,EAAEhC,IAC1DsC,QAAQC,IACd,uDAGMxE,KAAKkG,QACX,aACA,kBACQ,EAAR,iCACU,UACA,aACA,kBACA,sBAEV,SACU,QAAV,gDACU,OAAV,kBACU,EAAV,UAEA,UACU,QAAV,gCACU,EAAV,QACU,EAAV,+CAGA,UACQ,QAAR,sBCtL2V,ICOvV,EAAY,eACd,EACApG,EACAqC,GACA,EACA,KACA,KACA,MAIa,e,2CClBf,IAAIrC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,SAAS,CAACS,YAAY,cAAcD,MAAM,CAAC,OAASZ,EAAIgC,UAAUvB,OAAO,CAAET,EAAIgC,UAAe,MAAE5B,EAAG,cAAc,CAACJ,EAAIM,GAAG,eAAeN,EAAIO,GAAGP,EAAIgC,UAAUsC,QAAQzC,QAAQ,gBAAqC,MAApB7B,EAAIgC,UAAUE,GAAY9B,EAAG,cAAc,CAACJ,EAAIM,GAAG,cAAcN,EAAIO,GAAGP,EAAIgC,UAAUsC,QAAQzC,QAAQ,mBAAmBzB,EAAG,cAAc,CAACJ,EAAIM,GAAG,gBAAgBN,EAAIO,GAAGP,EAAIgC,UAAUsC,QAAQzC,QAAQ,gBAAgB7B,EAAI+B,GAAI/B,EAAIgC,UAAiB,SAAE,SAASK,EAAOJ,GAAO,OAAO7B,EAAG,gBAAgB,CAACM,IAAI2B,EAAOH,GAAKD,EAAMpB,YAAY,OAAOD,MAAM,CAAC,QAA8B,MAApBZ,EAAIgC,UAAUE,IAAclC,EAAIgC,UAAUyD,MAC3qB,MACCzF,EAAIgC,UAAUyD,OAAkB,GAATxD,EAExB,MADA,QACQ,CAAEjC,EAAIQ,UAAkB,SAAEJ,EAAG,eAAe,CAACQ,MAAM,CAAC,SAAW,GAAG,MAAS,KAAOqB,EAAQ,GAAK,KAAQI,EAAW,QAAOrC,EAAIQ,UAAoB,WAAEJ,EAAG,eAAe,CAACQ,MAAM,CAAC,SAAW,GAAG,MAAS,KAAOqB,EAAQ,GAAK,KAAQI,EAAW,KAAI,SAAYA,EAAOiE,SAEtQjE,EAAOiE,SACJC,WACAC,QAAQ,0BAA2B,OAHtC,OAGgD,SAAYnE,EAAOoE,MAEnEpE,EAAOoE,MACJF,WACAC,QAAQ,0BAA2B,OAHtC,OAGgD,kBAAmBpG,EAAG,eAAe,CAACQ,MAAM,CAAC,SAAW,GAAG,MAAS,KAAOqB,EAAQ,GAAK,KAAQI,EAAW,KAAI,QAAWA,EAAe,SAAI,QAAWA,EAAY,MAAI,kBAAoBrC,EAAI0G,eAAiB1G,EAAIQ,UAAUmG,UAAY3G,EAAIQ,UAAUoG,WAAYxG,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,UAAU,SAAWyB,EAAOwE,WAAW1F,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAI8G,aAAa7E,MAAU,CAACjC,EAAIM,GAAGN,EAAIO,GAAG8B,EAAOwE,UAAY,MAAQ,SAAS7G,EAAI0B,KAAKtB,EAAG,uBAAuB,CAAEJ,EAAIQ,UAAkB,SAAEJ,EAAG,MAAM,CAAsB,MAApBJ,EAAIgC,UAAUE,GAAY9B,EAAG,gBAAgB,CAACQ,MAAM,CAAC,QAAUZ,EAAI+G,kBAAkB5F,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAOpB,EAAIgH,WAAW5F,EAAQa,KAASS,MAAM,CAAC1B,MAAOqB,EAAqB,eAAEO,SAAS,SAAUC,GAAM7C,EAAI8C,KAAKT,EAAQ,iBAAkBQ,IAAM5B,WAAW,2BAA2BjB,EAAI0B,MAAO1B,EAAIgC,UAAUyD,OAASzF,EAAIgC,UAAUE,IAAMD,EAAQ,EAAG7B,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,QAAQO,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIiH,UAAUhF,MAAU,CAACjC,EAAIM,GAAG,UAAUN,EAAI0B,KAAKtB,EAAG,WAAW,CAACQ,MAAM,CAAC,QAAU,WAAWO,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIkH,aAAajF,MAAU,CAACjC,EAAIM,GAAGN,EAAIO,GAAGP,EAAIgC,UAAUyD,MAAQ,KAAO,UAAU,GAAGzF,EAAI0B,QAAQ,OAAM,IAAI,IACluCU,EAAkB,G,6CCkFtB,GACE3B,KAAM,YACNsC,MAAO,CACLf,UAAW,CAAf,0BAEEkB,KAAM,WACJ,MAAO,CACLiE,iBAAiB,IAGrB9D,SAAU,IACZ,gBACA,eACA,YACA,aACA,oBACA,mBACA,qBAGEG,QAAS,CACP,WAAWxC,EAAOiB,GAChBuC,QAAQC,IAAI,aAAazD,YAAgBiB,KACzC,MAAMI,EAASpC,KAAK+B,UAAUsC,QAAQrC,GACtChC,KAAK+B,UAAUsC,QAAQqB,OAAO1D,EAAO,GAErC,IAAK,IAAIwB,EAAI,EAAGA,EAAIxD,KAAKkE,WAAWtC,OAAQ4B,IAAK,CAC/C,MAAMW,EAAOnE,KAAKkE,WAAWV,GAC7B,GAAIW,EAAKlC,IAAMG,EAAO+E,eAAgB,CACpC/E,EAAO+E,eAAiB,KACxBhD,EAAKE,QAAQV,KAAKvB,GAClB,OAGJpC,KAAK2E,OAAOC,SAAS,EAA3B,oBAEI,aAAa5C,GACX,MAAMI,EAASpC,KAAK+B,UAAUsC,QAAQrC,GACtChC,KAAK+B,UAAUsC,QAAQqB,OAAO1D,EAAO,GAEjChC,KAAK+B,UAAUE,GACjBjC,KAAKkE,WAAW,GAAGG,QAAQV,KAAKvB,GAEhCpC,KAAK2B,gBAAgBgC,KAAKvB,GAG5BpC,KAAK2E,OAAOC,SAAS,EAA3B,oBAEI,UAAU5C,GACR,MAAMI,EAASpC,KAAK+B,UAAUsC,QAAQrC,GACtChC,KAAK+B,UAAUsC,QAAQqB,OAAO1D,EAAO,GACrChC,KAAK+B,UAAUsC,QAAQqB,OAAO,EAAG,EAAGtD,GAEpCpC,KAAK2E,OAAOC,SAAS,EAA3B,oBAEI,aAAa5C,GACX,MAAMI,EAASpC,KAAK+B,UAAUsC,QAAQrC,GAEtCuC,QAAQC,IAAI,kBAAkB4C,KAAKC,UAAUjF,IAE7C,IAAIkF,EAAM,KAAKlF,EAAO5B,UAAUR,KAAKO,UAAUgH,kBAE/C,MAAM9C,EAAU,CACdkB,OAAQ,KACRC,WAAY,KACZC,QAAQ,GAEJC,EAAU,CACdC,MAAO/F,KAAKO,UAAUgH,aACtBvB,KAAMsB,GAEFrB,EAAgBjG,KAEtBA,KAAKkG,QACX,aACA,kBACQ,EAAR,+CACU,OAAV,KACU,WAAV,yBAEA,SACU,QAAV,IACA,0DAEU,EAAV,sBACU,EAAV,QACU,OAAV,oBAEA,UACU,QAAV,8CACU,EAAV,QACU,EAAV,cACA,+CAIA,UACQ,QAAR,sBChMmV,I,YCO/UrB,EAAY,eACd,EACA/E,EACAqC,GACA,EACA,KACA,KACA,MAIa,OAAA0C,E","file":"js/chunk-11c72313.1db1bea4.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.isLoadingStudents)?_c('div',[_vm._v(\"\\n    正在获取学员详情...\\n  \")]):_c('div',[_c('h3',[_vm._v(_vm._s(_vm.classInfo.name)+\" -- 学员管理\")]),_c('ClassAdmin',{key:_vm.initComponentKey,attrs:{\"forStudentManagement\":true}}),_c('hr'),_c('div',{staticClass:\"input-group mb-3\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.newClassTeamName),expression:\"newClassTeamName\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"aria-describedby\":\"basic-addon2\",\"placeholder\":\"输入新组名称\"},domProps:{\"value\":(_vm.newClassTeamName)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.newClassTeamName=$event.target.value}}}),_c('b-button',{attrs:{\"variant\":\"info\"},on:{\"click\":_vm.createClassTeam}},[_vm._v(\"创建新组\")]),(_vm.classTeamsChanged)?_c('b-button',{attrs:{\"variant\":\"success\"},on:{\"click\":_vm.submitClassTeams}},[_vm._v(\"保存修改\")]):_vm._e(),(_vm.classTeamsChanged)?_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.resetClassTeams}},[_vm._v(\"放弃修改\")]):_vm._e()],1),(_vm.removedStudents.length > 0)?_c('ClassTeam',{attrs:{\"classTeam\":_vm.dummyClassTeam()}}):_vm._e(),_vm._l((_vm.classTeams),function(classTeam,index){return _c('div',{key:classTeam.id + classTeam.name + index},[_c('ClassTeam',{attrs:{\"classTeam\":classTeam}}),(index > 0)?_c('b-button',{attrs:{\"block\":\"\",\"variant\":\"warning\"},on:{\"click\":function($event){return _vm.removeClass(index)}}},[_vm._v(\"删除本组\")]):_vm._e(),_c('hr')],1)})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-card',{staticClass:\"text-center\",attrs:{\"header\":\"中组管理\"}},_vm._l((_vm.classAdminUsers),function(member,index){return _c('b-input-group',{key:index,staticClass:\"mt-3\",attrs:{\"prepend\":member.role}},[_c('b-form-input',{attrs:{\"readonly\":\"\",\"value\":member.displayName}}),_c('b-input-group-append',[_c('b-form-select',{attrs:{\"options\":_vm.classAdminOptions(index)},on:{\"input\":function($event){return _vm.changeMember($event, index)}},model:{value:(_vm.newClassAdmins[index]),callback:function ($$v) {_vm.$set(_vm.newClassAdmins, index, $$v)},expression:\"newClassAdmins[index]\"}})],1)],1)}),1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-card class=\"text-center\" header=\"中组管理\">\n      <b-input-group\n        v-for=\"(member, index) in classAdminUsers\"\n        :key=\"index\"\n        :prepend=\"member.role\"\n        class=\"mt-3\"\n      >\n        <b-form-input readonly :value=\"member.displayName\"></b-form-input>\n        <b-input-group-append>\n          <b-form-select\n            v-model=\"newClassAdmins[index]\"\n            :options=\"classAdminOptions(index)\"\n            v-on:input=\"changeMember($event, index)\"\n          ></b-form-select>\n        </b-input-group-append>\n      </b-input-group>\n    </b-card>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport { RESET_STUDENTS } from \"../store/actions.type\";\n\nexport default {\n  name: \"ClassAdmin\",\n  props: {\n    forStudentManagement: Boolean\n  },\n  data: function() {\n    return {\n      classAdminCandidates: [],\n      classStatsCandidates: [],\n      newClassAdmins: []\n    };\n  },\n  computed: {\n    ...mapGetters([\"classInfo\", \"classTeams\", \"classAdminUsers\"])\n  },\n  mounted() {\n    this.buildNewClassAdmin();\n    this.buildOptions();\n  },\n  methods: {\n    buildNewClassAdmin() {\n      const newClassAdmins = [];\n      for (var i = 0; i < this.classAdminUsers.length; i++) {\n        const user = this.classAdminUsers[i];\n        newClassAdmins.push(user.id);\n      }\n      this.newClassAdmins = newClassAdmins;\n    },\n    buildOptions() {\n      this.classAdminCandidates = [];\n      for (var i = 0; i < this.classInfo.classAdminStudents.length; i++) {\n        const user = this.classInfo.classAdminStudents[i];\n        if (user && user.roles.some(role => role == \"ClassAdminUser\")) {\n          this.classAdminCandidates.push(user);\n        }\n      }\n\n      this.classAdminCandidates = this.classAdminCandidates.concat(\n        this.classInfo.classAdminCandidates\n      );\n      this.classAdminCandidates = this.classAdminCandidates.map(e => {\n        return { value: e.id, text: e.name, roles: e.roles };\n      });\n\n      this.classStatsCandidates = [];\n      for (i = 0; i < this.classTeams.length; i++) {\n        const team = this.classTeams[i];\n        for (var j = 0; j < team.members.length; j++) {\n          const member = team.members[j];\n          if (!this.classAdminCandidates.some(e => e.value == member.id)) {\n            this.classStatsCandidates.push({\n              value: member.id,\n              text: member.name,\n              roles: member.roles\n            });\n          }\n        }\n      }\n    },\n    classAdminOptions(index) {\n      if (index < 2) {\n        return this.classAdminCandidates;\n      }\n      return this.classStatsCandidates;\n    },\n    changeMember(value, index) {\n      if (value == this.classAdminUsers[index].id) {\n        return;\n      }\n\n      console.log(`selected ${value} index: ${index}`);\n      const options = this.classAdminOptions(index);\n\n      for (var i = 0; i < options.length; i++) {\n        const option = options[i];\n        if (option.value == value) {\n          this.classAdminUsers[index].id = value;\n          this.classAdminUsers[index].name = option.name;\n          this.classAdminUsers[index].displayName = `(${index + 1}) ${\n            option.text\n          }`;\n          break;\n        }\n      }\n      this.$store.dispatch(RESET_STUDENTS, { changed: true });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassAdmin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassAdmin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClassAdmin.vue?vue&type=template&id=0278dcb0&\"\nimport script from \"./ClassAdmin.vue?vue&type=script&lang=js&\"\nexport * from \"./ClassAdmin.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div>\n    <div v-if=\"isLoadingStudents\">\n      正在获取学员详情...\n    </div>\n    <div v-else>\n      <h3>{{ classInfo.name }} -- 学员管理</h3>\n      <ClassAdmin :key=\"initComponentKey\" :forStudentManagement=\"true\" />\n      <hr />\n      <div class=\"input-group mb-3\">\n        <input\n          type=\"text\"\n          class=\"form-control\"\n          aria-describedby=\"basic-addon2\"\n          v-model=\"newClassTeamName\"\n          placeholder=\"输入新组名称\"\n        />\n        <b-button variant=\"info\" @click=\"createClassTeam\">创建新组</b-button>\n        <b-button\n          variant=\"success\"\n          v-if=\"classTeamsChanged\"\n          @click=\"submitClassTeams\"\n          >保存修改</b-button\n        >\n        <b-button\n          variant=\"warning\"\n          v-if=\"classTeamsChanged\"\n          @click=\"resetClassTeams\"\n          >放弃修改</b-button\n        >\n      </div>\n      <ClassTeam\n        v-if=\"removedStudents.length > 0\"\n        :classTeam=\"dummyClassTeam()\"\n      />\n      <div\n        v-for=\"(classTeam, index) in classTeams\"\n        :key=\"classTeam.id + classTeam.name + index\"\n      >\n        <ClassTeam :classTeam=\"classTeam\" />\n        <b-button\n          v-if=\"index > 0\"\n          block\n          variant=\"warning\"\n          @click=\"removeClass(index)\"\n          >删除本组</b-button\n        >\n        <hr />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport ClassTeam from \"@/components/ClassTeam\";\nimport ClassAdmin from \"@/components/ClassAdmin\";\nimport { FETCH_STUDENTS, RESET_STUDENTS } from \"../store/actions.type\";\nimport store from \"@/store\";\nimport Parse from \"parse\";\n\nexport default {\n  name: \"StudentManagement\",\n  components: {\n    ClassTeam,\n    ClassAdmin\n  },\n  computed: {\n    ...mapGetters([\n      \"isLoadingStudents\",\n      \"classInfo\",\n      \"classTeams\",\n      \"isClassAdmin\",\n      \"isSystemAdmin\",\n      \"classTeamsChanged\",\n      \"removedStudents\",\n      \"initComponentKey\",\n      \"classAdminUsers\"\n    ])\n  },\n  beforeRouteEnter(to, from, next) {\n    store.dispatch(FETCH_STUDENTS, to.params).then(() => {\n      next();\n    });\n  },\n  data: function() {\n    return {\n      newClassTeamName: \"\",\n      creatingClassTeam: false\n    };\n  },\n  methods: {\n    dummyClassTeam() {\n      return {\n        id: `DUMMY_${this.newClassTeamName}_${new Date().getTime()}`,\n        dummy: true,\n        name: \"将删除学员\",\n        members: this.removedStudents\n      };\n    },\n    createClassTeam() {\n      const classTeam = {\n        id: `NEW_${this.newClassTeamName}_${new Date().getTime()}`,\n        classId: this.classInfo.id,\n        name: this.newClassTeamName,\n        members: []\n      };\n      this.newClassTeamName = \"\";\n      this.classTeams.push(classTeam);\n      store.dispatch(RESET_STUDENTS, { changed: true });\n    },\n    removeClass(index) {\n      this.classTeams[0].members = this.classTeams[0].members.concat(\n        this.classTeams[index].members\n      );\n      this.classTeams.splice(index, 1);\n      store.dispatch(RESET_STUDENTS, { changed: true });\n    },\n    resetClassTeams() {\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\",\n        loader: true // default: false - when set to true, the proceed button shows a loader when clicked; and a dialog object will be passed to the then() callback\n      };\n      const message = {\n        title: this.classInfo.name,\n        body: \"放弃所做修改?\"\n      };\n      const thisComponent = this;\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function(dialog) {\n          thisComponent.newClassTeamName = \"\";\n          thisComponent.classInfo.changed = false;\n          store.dispatch(RESET_STUDENTS, thisComponent.classInfo);\n          dialog.close();\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    },\n    submitClassTeams() {\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\",\n        loader: true // default: false - when set to true, the proceed button shows a loader when clicked; and a dialog object will be passed to the then() callback\n      };\n      const message = {\n        title: this.classInfo.name,\n        body: \"保存所做修改?\"\n      };\n      const thisComponent = this;\n      const classId = this.classInfo.id;\n      const classTeams = this.classTeams.filter(e => e.id);\n      const removedStudents = this.removedStudents;\n      const classAdminUserIds = this.classAdminUsers.map(e => e.id);\n      console.log(\n        `updateTeams - classAdminUserIds: ${JSON.stringify(classAdminUserIds)}`\n      );\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function(dialog) {\n          Parse.Cloud.run(\"class:updateTeams\", {\n            classId,\n            classTeams,\n            removedStudents,\n            classAdminUserIds\n          })\n            .then(result => {\n              console.log(`updateTeams - result: ${JSON.stringify(result)}`);\n              window.location.reload();\n              dialog.close();\n            })\n            .catch(e => {\n              console.log(`error in updateTeams: ${e}`);\n              dialog.close();\n              thisComponent.$dialog.alert(`error in updateTeams: ${e}`);\n            });\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StudentManagement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./StudentManagement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./StudentManagement.vue?vue&type=template&id=7eef4bb6&\"\nimport script from \"./StudentManagement.vue?vue&type=script&lang=js&\"\nexport * from \"./StudentManagement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('b-card',{staticClass:\"text-center\",attrs:{\"header\":_vm.classTeam.name}},[(_vm.classTeam.dummy)?_c('b-card-text',[_vm._v(\"\\n      将删除 \"+_vm._s(_vm.classTeam.members.length)+\" 名学员\\n    \")]):(_vm.classTeam.id == null)?_c('b-card-text',[_vm._v(\"\\n      共有 \"+_vm._s(_vm.classTeam.members.length)+\" 名学员未分组\\n    \")]):_c('b-card-text',[_vm._v(\"\\n      本组共有 \"+_vm._s(_vm.classTeam.members.length)+\" 名学员\\n    \")]),_vm._l((_vm.classTeam.members),function(member,index){return _c('b-input-group',{key:member.id + index,staticClass:\"mt-3\",attrs:{\"prepend\":_vm.classTeam.id == null || _vm.classTeam.dummy\n          ? '学员：'\n          : !_vm.classTeam.dummy && index == 0\n          ? '组长：'\n          : '组员：'}},[(_vm.classInfo.forAdmin)?_c('b-form-input',{attrs:{\"readonly\":\"\",\"value\":(\"(\" + (index + 1) + \") \" + (member.name))}}):(_vm.classInfo.practiceId)?_c('b-form-input',{attrs:{\"readonly\":\"\",\"value\":(\"(\" + (index + 1) + \") \" + (member.name) + \"\\t上周：\" + (!member.lastWeek\n              ? '未报数'\n              : member.lastWeek\n                  .toString()\n                  .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')) + \"\\t总计：\" + (!member.count\n              ? '未报数'\n              : member.count\n                  .toString()\n                  .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')) + \"\\n          \")}}):_c('b-form-input',{attrs:{\"readonly\":\"\",\"value\":(\"(\" + (index + 1) + \") \" + (member.name) + \"\\t上周：\" + (member.lastWeek) + \"\\t总计：\" + (member.count) + \"\\n          \")}}),(_vm.isClassAdmin && !_vm.classInfo.forAdmin && _vm.classInfo.practiceId)?_c('b-button',{attrs:{\"variant\":\"success\",\"disabled\":member.completed},on:{\"click\":function($event){return _vm.setCompleted(index)}}},[_vm._v(_vm._s(member.completed ? \"已圆满\" : \"圆满\"))]):_vm._e(),_c('b-input-group-append',[(_vm.classInfo.forAdmin)?_c('div',[(_vm.classTeam.id == null)?_c('b-form-select',{attrs:{\"options\":_vm.classTeamOptions},on:{\"change\":function($event){return _vm.assignTeam($event, index)}},model:{value:(member.assignedTeamId),callback:function ($$v) {_vm.$set(member, \"assignedTeamId\", $$v)},expression:\"member.assignedTeamId\"}}):_vm._e(),(!_vm.classTeam.dummy && _vm.classTeam.id && index > 0)?_c('b-button',{attrs:{\"variant\":\"info\"},on:{\"click\":function($event){return _vm.setLeader(index)}}},[_vm._v(\"设为组长\")]):_vm._e(),_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":function($event){return _vm.removeMember(index)}}},[_vm._v(_vm._s(_vm.classTeam.dummy ? \"恢复\" : \"删除\"))])],1):_vm._e()])],1)})],2)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <b-card class=\"text-center\" :header=\"classTeam.name\">\n      <b-card-text v-if=\"classTeam.dummy\">\n        将删除 {{ classTeam.members.length }} 名学员\n      </b-card-text>\n      <b-card-text v-else-if=\"classTeam.id == null\">\n        共有 {{ classTeam.members.length }} 名学员未分组\n      </b-card-text>\n      <b-card-text v-else>\n        本组共有 {{ classTeam.members.length }} 名学员\n      </b-card-text>\n      <b-input-group\n        v-for=\"(member, index) in classTeam.members\"\n        :key=\"member.id + index\"\n        :prepend=\"\n          classTeam.id == null || classTeam.dummy\n            ? '学员：'\n            : !classTeam.dummy && index == 0\n            ? '组长：'\n            : '组员：'\n        \"\n        class=\"mt-3\"\n      >\n        <b-form-input\n          v-if=\"classInfo.forAdmin\"\n          readonly\n          :value=\"`(${index + 1}) ${member.name}`\"\n        ></b-form-input>\n        <b-form-input\n          v-else-if=\"classInfo.practiceId\"\n          readonly\n          :value=\"\n            `(${index + 1}) ${member.name}\\t上周：${\n              !member.lastWeek\n                ? '未报数'\n                : member.lastWeek\n                    .toString()\n                    .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')\n            }\\t总计：${\n              !member.count\n                ? '未报数'\n                : member.count\n                    .toString()\n                    .replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,')\n            }\n            `\n          \"\n        ></b-form-input>\n        <b-form-input\n          v-else\n          readonly\n          :value=\"\n            `(${index + 1}) ${member.name}\\t上周：${member.lastWeek}\\t总计：${\n              member.count\n            }\n            `\n          \"\n        ></b-form-input>\n        <b-button\n          v-if=\"isClassAdmin && !classInfo.forAdmin && classInfo.practiceId\"\n          variant=\"success\"\n          v-on:click=\"setCompleted(index)\"\n          :disabled=\"member.completed\"\n          >{{ member.completed ? \"已圆满\" : \"圆满\" }}</b-button\n        >\n        <b-input-group-append>\n          <div v-if=\"classInfo.forAdmin\">\n            <b-form-select\n              v-if=\"classTeam.id == null\"\n              v-model=\"member.assignedTeamId\"\n              :options=\"classTeamOptions\"\n              v-on:change=\"assignTeam($event, index)\"\n            ></b-form-select>\n            <b-button\n              v-if=\"!classTeam.dummy && classTeam.id && index > 0\"\n              variant=\"info\"\n              v-on:click=\"setLeader(index)\"\n              >设为组长</b-button\n            >\n            <b-button variant=\"warning\" v-on:click=\"removeMember(index)\">{{\n              classTeam.dummy ? \"恢复\" : \"删除\"\n            }}</b-button>\n          </div>\n        </b-input-group-append>\n      </b-input-group>\n    </b-card>\n  </div>\n</template>\n\n<script>\nimport Parse from \"parse\";\nimport { mapGetters } from \"vuex\";\nimport { RESET_STUDENTS } from \"../store/actions.type\";\n\nexport default {\n  name: \"ClassTeam\",\n  props: {\n    classTeam: { type: Object, required: true }\n  },\n  data: function() {\n    return {\n      canAddSubmodule: false\n    };\n  },\n  computed: {\n    ...mapGetters([\n      \"isClassAdmin\",\n      \"classInfo\",\n      \"classTeams\",\n      \"classTeamsChanged\",\n      \"classTeamOptions\",\n      \"removedStudents\"\n    ])\n  },\n  methods: {\n    assignTeam(value, index) {\n      console.log(`selected: ${value} index: ${index}`);\n      const member = this.classTeam.members[index];\n      this.classTeam.members.splice(index, 1);\n\n      for (var i = 0; i < this.classTeams.length; i++) {\n        const team = this.classTeams[i];\n        if (team.id == member.assignedTeamId) {\n          member.assignedTeamId = null;\n          team.members.push(member);\n          break;\n        }\n      }\n      this.$store.dispatch(RESET_STUDENTS, { changed: true });\n    },\n    removeMember(index) {\n      const member = this.classTeam.members[index];\n      this.classTeam.members.splice(index, 1);\n\n      if (this.classTeam.id) {\n        this.classTeams[0].members.push(member);\n      } else {\n        this.removedStudents.push(member);\n      }\n\n      this.$store.dispatch(RESET_STUDENTS, { changed: true });\n    },\n    setLeader(index) {\n      const member = this.classTeam.members[index];\n      this.classTeam.members.splice(index, 1);\n      this.classTeam.members.splice(0, 0, member);\n\n      this.$store.dispatch(RESET_STUDENTS, { changed: true });\n    },\n    setCompleted(index) {\n      const member = this.classTeam.members[index];\n\n      console.log(`setCompleted - ${JSON.stringify(member)}`);\n\n      var msg = `确认${member.name}已圆满${this.classInfo.practiceName}实修?`;\n\n      const options = {\n        okText: \"确认\",\n        cancelText: \"取消\",\n        loader: true // default: false - when set to true, the proceed button shows a loader when clicked; and a dialog object will be passed to the then() callback\n      };\n      const message = {\n        title: this.classInfo.practiceName,\n        body: msg\n      };\n      const thisComponent = this;\n\n      this.$dialog\n        .confirm(message, options)\n        .then(function(dialog) {\n          Parse.Cloud.run(\"admin:markUserPracticeCompleted\", {\n            userId: member.id,\n            practiceId: thisComponent.classInfo.practiceId\n          })\n            .then(result => {\n              console.log(\n                `markUserPracticeCompleted - result: ${JSON.stringify(result)}`\n              );\n              member.completed = result.completed;\n              dialog.close();\n              window.location.reload();\n            })\n            .catch(e => {\n              console.log(`error in markUserPracticeCompleted: ${e}`);\n              dialog.close();\n              thisComponent.$dialog.alert(\n                `error in markUserPracticeCompleted: ${e}`\n              );\n            });\n        })\n        .catch(e => {\n          console.log(`error: ${e}`);\n        });\n    }\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassTeam.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassTeam.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClassTeam.vue?vue&type=template&id=b96f7cbc&\"\nimport script from \"./ClassTeam.vue?vue&type=script&lang=js&\"\nexport * from \"./ClassTeam.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}