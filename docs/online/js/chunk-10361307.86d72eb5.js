(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-10361307"],{"2c65":function(e,t,n){},"383f":function(e,t,n){"use strict";n("2c65")},9597:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-form",{on:{submit:e.onSubmit,reset:e.onReset}},[n("h4",[e._v("Run Admin Functions")]),n("TextReader",{on:{load:function(t){e.fields=t}}}),n("b-form-textarea",{attrs:{value:JSON.stringify(e.fields,null,4),placeholder:"CSV fields will appear here",rows:"2","max-rows":"10",readonly:""}}),e.fields?n("VueCsvImport",{attrs:{"map-fields":e.fields,autoMatchFields:!0},model:{value:e.parseCsv,callback:function(t){e.parseCsv=t},expression:"parseCsv"}}):e._e(),e.parseCsv?n("b-form-textarea",{attrs:{value:JSON.stringify(e.parseCsv,null,4),placeholder:"JSON converted from CSV file content will appear here",rows:"8","max-rows":"20",readonly:""}}):e._e(),n("b-form-textarea",{attrs:{placeholder:"Enter parameters",rows:"8","max-rows":"20"},model:{value:e.params,callback:function(t){e.params=t},expression:"params"}}),n("b-input-group",{staticClass:"mt-3",attrs:{prepend:"Name："}},[n("b-form-input",{attrs:{placeholder:"Enter function name",trim:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),n("b-input-group-append",[n("b-button",{attrs:{type:"reset",variant:"warning"}},[n("b-icon",{attrs:{icon:"x-circle"}})],1),n("b-button",{attrs:{type:"submit",variant:"success"}},[n("b-icon",{attrs:{icon:"check-circle"}})],1)],1)],1)],1),n("JsonExcel",{staticClass:"btn btn-info btn-block",attrs:{data:e.parseCsv,worksheet:"My Worksheet",name:"filename.xls"}},[e._v("\n    下载报表\n  ")]),n("hr"),n("div",{staticClass:"multiline"},[e._v("Params: "+e._s(e.text))]),n("div",{staticClass:"multiline"},[e._v("Result: "+e._s(e.result))])],1)},s=[],r=n("bf48"),o=n.n(r),i=n("505f"),l=n("7d8b"),c=n("f2d9"),u=n("2b0e");u["default"].component("JsonExcel",c["a"]);var m={name:"ImportData",components:{TextReader:i["a"],VueCsvImport:l["VueCsvImport"],JsonExcel:c["a"]},data:function(){return{name:"",params:"",result:"",text:"",parseCsv:void 0,fields:void 0}},methods:{onReset(e){e.preventDefault(),window.location.reload()},onSubmit(e){e.preventDefault();const t={okText:"Confirm",cancelText:"Cancel",loader:!0},n=JSON.parse(this.params);this.name&&0!=this.name.length||(this.name=n.functionName);const a={title:"Run Admin Function",body:`Confirm to run function ${this.name}？`},s=this;this.text="",this.result="",this.$dialog.confirm(a,t).then((async function(e){var t=0;while(t<5)t+=1,n.csv=s.parseCsv.filter(e=>{const n=e["组别"];return n==t.toString()}),0!=n.csv.length&&(console.log(`importing data for team: ${t} #records: ${n.csv.length}`),s.text+=`${t} - ${JSON.stringify(n,null,4)}`,await o.a.Cloud.run(s.name,n).then(e=>{s.result+=`${t} - ${JSON.stringify(e,null,4)}`}).catch(e=>{s.result+=`${t} - ${JSON.stringify(e,null,4)}`}));e.close()})).catch(e=>{console.log("error: "+e)})}}},p=m,f=(n("383f"),n("2877")),d=Object(f["a"])(p,a,s,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-10361307.86d72eb5.js.map